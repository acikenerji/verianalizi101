<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 dplyr ile Veri Manipülasyonu | R İLE ENERJİ PİYASASI VERİ ANALİZİ EL KİTABI</title>
  <meta name="description" content="2 dplyr ile Veri Manipülasyonu | R İLE ENERJİ PİYASASI VERİ ANALİZİ EL KİTABI" />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="2 dplyr ile Veri Manipülasyonu | R İLE ENERJİ PİYASASI VERİ ANALİZİ EL KİTABI" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 dplyr ile Veri Manipülasyonu | R İLE ENERJİ PİYASASI VERİ ANALİZİ EL KİTABI" />
  
  
  

<meta name="author" content="Son Güncelleme: 29.01.2020" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="ggplot2-ile-veri-görselleştirme.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href=index.html>R İLE ENERJİ PİYASASI VERİ ANALİZİ EL KİTABI</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Giriş</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#amaç"><i class="fa fa-check"></i><b>1.1</b> Amaç</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#kurulum"><i class="fa fa-check"></i><b>1.2</b> Kurulum</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#r-ve-rstudionun-indirilmesi"><i class="fa fa-check"></i><b>1.2.1</b> R ve RStudio’nun İndirilmesi</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#kurulumun-test-edilmesi"><i class="fa fa-check"></i><b>1.2.2</b> Kurulumun Test Edilmesi</a></li>
<li class="chapter" data-level="1.2.3" data-path="index.html"><a href="index.html#ilk-r-script-dosyasının-oluşturulması"><i class="fa fa-check"></i><b>1.2.3</b> İlk R Script Dosyasının Oluşturulması</a></li>
<li class="chapter" data-level="1.2.4" data-path="index.html"><a href="index.html#rda-paketler-hakkında"><i class="fa fa-check"></i><b>1.2.4</b> R’da Paketler Hakkında</a></li>
<li class="chapter" data-level="1.2.5" data-path="index.html"><a href="index.html#gerekli-paketlerin-indirilip-yüklenmesi"><i class="fa fa-check"></i><b>1.2.5</b> Gerekli Paketlerin İndirilip Yüklenmesi</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#veriseti"><i class="fa fa-check"></i><b>1.3</b> Dökümanda Kullanılan Veri Seti</a><ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#veri-setine-ilk-bakış"><i class="fa fa-check"></i><b>1.3.1</b> Veri Setine İlk Bakış</a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#veri-setinin-indirilmesi"><i class="fa fa-check"></i><b>1.3.2</b> Veri Setinin İndirilmesi</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="dplyr-ile-veri-manipülasyonu.html"><a href="dplyr-ile-veri-manipülasyonu.html"><i class="fa fa-check"></i><b>2</b> dplyr ile Veri Manipülasyonu</a><ul>
<li class="chapter" data-level="2.1" data-path="dplyr-ile-veri-manipülasyonu.html"><a href="dplyr-ile-veri-manipülasyonu.html#dplyrhazirliklar"><i class="fa fa-check"></i><b>2.1</b> Hazırlıklar</a></li>
<li class="chapter" data-level="2.2" data-path="dplyr-ile-veri-manipülasyonu.html"><a href="dplyr-ile-veri-manipülasyonu.html#önemli-fonksiyonlar"><i class="fa fa-check"></i><b>2.2</b> Önemli Fonksiyonlar</a><ul>
<li class="chapter" data-level="2.2.1" data-path="dplyr-ile-veri-manipülasyonu.html"><a href="dplyr-ile-veri-manipülasyonu.html#selectrename"><i class="fa fa-check"></i><b>2.2.1</b> <code>select</code>/<code>rename</code></a></li>
<li class="chapter" data-level="2.2.2" data-path="dplyr-ile-veri-manipülasyonu.html"><a href="dplyr-ile-veri-manipülasyonu.html#filter"><i class="fa fa-check"></i><b>2.2.2</b> <code>filter</code></a></li>
<li class="chapter" data-level="2.2.3" data-path="dplyr-ile-veri-manipülasyonu.html"><a href="dplyr-ile-veri-manipülasyonu.html#arrange"><i class="fa fa-check"></i><b>2.2.3</b> <code>arrange</code></a></li>
<li class="chapter" data-level="2.2.4" data-path="dplyr-ile-veri-manipülasyonu.html"><a href="dplyr-ile-veri-manipülasyonu.html#mutatetransmute"><i class="fa fa-check"></i><b>2.2.4</b> <code>mutate</code>/<code>transmute</code></a></li>
<li class="chapter" data-level="2.2.5" data-path="dplyr-ile-veri-manipülasyonu.html"><a href="dplyr-ile-veri-manipülasyonu.html#group_bysummarise"><i class="fa fa-check"></i><b>2.2.5</b> <code>group_by</code>/<code>summarise</code></a></li>
<li class="chapter" data-level="2.2.6" data-path="dplyr-ile-veri-manipülasyonu.html"><a href="dplyr-ile-veri-manipülasyonu.html#distinct"><i class="fa fa-check"></i><b>2.2.6</b> <code>distinct</code></a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="dplyr-ile-veri-manipülasyonu.html"><a href="dplyr-ile-veri-manipülasyonu.html#örnekler"><i class="fa fa-check"></i><b>2.3</b> Örnekler</a><ul>
<li class="chapter" data-level="2.3.1" data-path="dplyr-ile-veri-manipülasyonu.html"><a href="dplyr-ile-veri-manipülasyonu.html#basit-seviye"><i class="fa fa-check"></i><b>2.3.1</b> Basit Seviye</a></li>
<li class="chapter" data-level="2.3.2" data-path="dplyr-ile-veri-manipülasyonu.html"><a href="dplyr-ile-veri-manipülasyonu.html#ileri-seviye"><i class="fa fa-check"></i><b>2.3.2</b> İleri Seviye</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ggplot2-ile-veri-görselleştirme.html"><a href="ggplot2-ile-veri-görselleştirme.html"><i class="fa fa-check"></i><b>3</b> ggplot2 ile Veri Görselleştirme</a><ul>
<li class="chapter" data-level="3.1" data-path="ggplot2-ile-veri-görselleştirme.html"><a href="ggplot2-ile-veri-görselleştirme.html#hazırlıklar"><i class="fa fa-check"></i><b>3.1</b> Hazırlıklar</a></li>
<li class="chapter" data-level="3.2" data-path="ggplot2-ile-veri-görselleştirme.html"><a href="ggplot2-ile-veri-görselleştirme.html#nokta-grafiği-scatter-plot"><i class="fa fa-check"></i><b>3.2</b> Nokta Grafiği (Scatter Plot)</a></li>
<li class="chapter" data-level="3.3" data-path="ggplot2-ile-veri-görselleştirme.html"><a href="ggplot2-ile-veri-görselleştirme.html#sütunlu-grafik-bar-chart"><i class="fa fa-check"></i><b>3.3</b> Sütunlu Grafik (Bar Chart)</a></li>
<li class="chapter" data-level="3.4" data-path="ggplot2-ile-veri-görselleştirme.html"><a href="ggplot2-ile-veri-görselleştirme.html#çizgi-grafiği-line-chart"><i class="fa fa-check"></i><b>3.4</b> Çizgi Grafiği (Line Chart)</a></li>
<li class="chapter" data-level="3.5" data-path="ggplot2-ile-veri-görselleştirme.html"><a href="ggplot2-ile-veri-görselleştirme.html#isı-harıtası-heat-map"><i class="fa fa-check"></i><b>3.5</b> Isı Harıtası (Heat Map)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ekler.html"><a href="ekler.html"><i class="fa fa-check"></i>Ekler</a><ul>
<li class="chapter" data-level="" data-path="ekler.html"><a href="ekler.html#yazarlar-hakkında"><i class="fa fa-check"></i>Yazarlar Hakkında</a></li>
<li class="chapter" data-level="" data-path="ekler.html"><a href="ekler.html#rstudio-cloudda-çalışma"><i class="fa fa-check"></i>RStudio Cloud’da Çalışma</a></li>
<li class="chapter" data-level="" data-path="ekler.html"><a href="ekler.html#veri-seti-düzenlemeleri"><i class="fa fa-check"></i>Veri Seti Düzenlemeleri</a></li>
<li class="chapter" data-level="" data-path="ekler.html"><a href="ekler.html#kaynakça"><i class="fa fa-check"></i>Kaynakça</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R İLE ENERJİ PİYASASI VERİ ANALİZİ EL KİTABI</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="dplyr-ile-veri-manipülasyonu" class="section level1">
<h1><span class="header-section-number">2</span> dplyr ile Veri Manipülasyonu</h1>
<p>Bu bölümde hedeflenen şey, çok önemli ve oldukça güçlü bir data manipülasyonu paketi olan <code>dplyr</code> paketinin önemli fonksiyonlarına dair örnekler vererek nasıl kullanılabileceklerini göstermektir. Bu bölümde ele alınacak fonksiyonlar şu şekildedir:</p>
<p><code>select</code>/<code>rename</code><br />
<code>filter</code><br />
<code>distinct</code><br />
<code>arrange</code><br />
<code>mutate</code>/<code>transmute</code><br />
<code>group_by</code>/<code>summarise</code></p>
<p>Yukarıda bahsedilen bütün fonksiyonlar ayrı ayrı ele alınacak ve her biri için örnek kullanımlar gösterilecektir. Ayrıca “pipe operator” olarak adlandırılan “Bağlantı Operatörü” (<code>%&gt;%</code>) de kısaca anlatılacak ve bütün döküman boyunca kullanılacaktır.</p>
<div id="dplyrhazirliklar" class="section level2">
<h2><span class="header-section-number">2.1</span> Hazırlıklar</h2>
<p>Tablonun ilk haline <code>glimpse()</code> fonksiyonu ile göz atılabilir.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">ptfsmf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">glimpse</span>()</a></code></pre></div>
<pre><code>## Observations: 8,760
## Variables: 5
## $ Tarih &lt;dttm&gt; 2019-01-01 00:00:00, 2019-01-01 01:00:00, 2019-01-01 02:00:00,…
## $ PTF   &lt;dbl&gt; 100.38, 96.72, 81.60, 38.58, 11.52, 11.14, 11.14, 24.37, 34.50,…
## $ SMF   &lt;dbl&gt; 5.00, 95.04, 79.60, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0…
## $ PDF   &lt;dbl&gt; 4.85, 92.19, 77.21, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0…
## $ NDF   &lt;dbl&gt; 103.39, 99.62, 84.05, 39.74, 11.87, 11.47, 11.47, 25.10, 35.53,…</code></pre>
<p>Burada “Bağlantı Operatörü”nün (<code>%&gt;%</code>) kullanımına dikkat edilmelidir. Eğer bu “Bağlantı Operatörü” kullanılmasaydı aynı işlem şu şekilde gerçekleştirilecekti,</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">glimpse</span>(ptfsmf)</a></code></pre></div>
<pre><code>## Observations: 8,760
## Variables: 5
## $ Tarih &lt;dttm&gt; 2019-01-01 00:00:00, 2019-01-01 01:00:00, 2019-01-01 02:00:00,…
## $ PTF   &lt;dbl&gt; 100.38, 96.72, 81.60, 38.58, 11.52, 11.14, 11.14, 24.37, 34.50,…
## $ SMF   &lt;dbl&gt; 5.00, 95.04, 79.60, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0…
## $ PDF   &lt;dbl&gt; 4.85, 92.19, 77.21, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0…
## $ NDF   &lt;dbl&gt; 103.39, 99.62, 84.05, 39.74, 11.87, 11.47, 11.47, 25.10, 35.53,…</code></pre>
<p>Yukarıdaki örnekte tek bir fonksiyon kullanıldığından daha kolay görünmeyebilir ancak şu örnek daha belirleyici olacaktır. (Bu örnekte kullanılan <code>select</code> fonksiyonu aşağıda daha detaylı anlatılacaktır, burada sadece örnek olması açısından kullanılmıştır.)</p>
<ol style="list-style-type: decimal">
<li>Bağlantı Operatörü kullanılarak PTF ve SMF sütunlarının seçilmesi ve gösterilmesi,</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">ptfsmf <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(PTF, SMF) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="st">  </span><span class="kw">glimpse</span>()</a></code></pre></div>
<pre><code>## Observations: 8,760
## Variables: 2
## $ PTF &lt;dbl&gt; 100.38, 96.72, 81.60, 38.58, 11.52, 11.14, 11.14, 24.37, 34.50, 4…
## $ SMF &lt;dbl&gt; 5.00, 95.04, 79.60, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.0…</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Bağlantı Operatörü kullanılmadan PTF ve SMF sütunlarının seçilmesi ve gösterilmesi,</li>
</ol>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw">glimpse</span>(<span class="kw">select</span>(ptfsmf, PTF, SMF))</a></code></pre></div>
<pre><code>## Observations: 8,760
## Variables: 2
## $ PTF &lt;dbl&gt; 100.38, 96.72, 81.60, 38.58, 11.52, 11.14, 11.14, 24.37, 34.50, 4…
## $ SMF &lt;dbl&gt; 5.00, 95.04, 79.60, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.0…</code></pre>
<p>Görebileceğiniz üzere bu operatör sayesinde farklı fonksiyonları iç içe yazmak yerine alt alta daha tertipli bir şekilde yazabiliriz.</p>
<!-- Bir diğer önemli konu ise kullandığımız `ptfsmf` objesinin detaylarıdır. Bu obje R'ın pek çok veri tipinden biri olan "Data Frame" tipindedir. "Data Frame" matrislere oldukça benzese de farklı veri tiplerinde veriler depolayabilmesiyle matrislerden ayrılırlar. Örneğin `ptfsmf` objesinin "Tarih" sütunu bir tarih tipi olan `POSIXct` tipinde, geri kalan sütunlar ise `numeric` tipindedir. Bu tiplere hakim olmanız bu döküman için gerekli değildir.  -->
<blockquote>
<p>Aşağıdaki örnekleri incelerken aklınıza “Uygulanan bu işlemler neden kalıcı olmadı, ptfsmf objesi neden değişmedi?” gibi sorular gelebilir. Bu R programlama dilinin bir özelliğinden kaynaklanmaktadır. <code>&lt;-</code> veya <code>=</code> atama operatörlerinden biri kullanılmadığı sürece yazılan işlemler gerçekleştirilecek ve ekrana yansıtılacak ancak <code>ptfsmf</code> objesinde bir değişiklik olmayacaktır.</p>
</blockquote>
<p>Şimdi <code>dplyr</code> paketinin önemli fonksiyonları ile devam edebiliriz.</p>
</div>
<div id="önemli-fonksiyonlar" class="section level2">
<h2><span class="header-section-number">2.2</span> Önemli Fonksiyonlar</h2>
<div id="selectrename" class="section level3">
<h3><span class="header-section-number">2.2.1</span> <code>select</code>/<code>rename</code></h3>
<p><code>select</code> fonksiyonu belirli sutünları seçmek için kullanılır. Örneğin tablonun sadece Tarih ve Piyasa Takas Fiyatı’nı (PTF) göstermesi isteniyorsa,</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">ptfsmf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(Tarih, PTF)</a></code></pre></div>
<pre><code>## # A tibble: 8,760 x 2
##    Tarih                 PTF
##    &lt;dttm&gt;              &lt;dbl&gt;
##  1 2019-01-01 00:00:00 100. 
##  2 2019-01-01 01:00:00  96.7
##  3 2019-01-01 02:00:00  81.6
##  4 2019-01-01 03:00:00  38.6
##  5 2019-01-01 04:00:00  11.5
##  6 2019-01-01 05:00:00  11.1
##  7 2019-01-01 06:00:00  11.1
##  8 2019-01-01 07:00:00  24.4
##  9 2019-01-01 08:00:00  34.5
## 10 2019-01-01 09:00:00  45.2
## # … with 8,750 more rows</code></pre>
<p>Veya (bu örnek için pek faydalı gibi görünmese de) içinde “P” harfini barındıran sütunlar seçilmek istendiğinde <code>contains</code> kelimesi kullanılabilir.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">ptfsmf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="kw">contains</span>(<span class="st">&quot;P&quot;</span>))</a></code></pre></div>
<pre><code>## # A tibble: 8,760 x 2
##      PTF   PDF
##    &lt;dbl&gt; &lt;dbl&gt;
##  1 100.   4.85
##  2  96.7 92.2 
##  3  81.6 77.2 
##  4  38.6  0   
##  5  11.5  0   
##  6  11.1  0   
##  7  11.1  0   
##  8  24.4  0   
##  9  34.5  0   
## 10  45.2  0   
## # … with 8,750 more rows</code></pre>
<p>Bu kelime gibi <code>select</code> fonksiyonu içinde kullanılabilecek diğer kelimeler: <code>starts_with</code>, <code>ends_with</code>, <code>matches</code> olarak sıralanabilir.</p>
<blockquote>
<p>Bu kelimeler ve daha fazlasının anlatıldığı <a href="https://rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf" target="_blank">dplyr Cheatsheet</a> dökümanına göz atılabilir.</p>
</blockquote>
<p>Aynı zamanda, eğer sütunların sırası biliniyorsa iki sütun arasındaki her sütunu seçmek için <code>:</code> operatörü kullanılabilir. Örneğin Sistem Marjinal Fiyatı (SMF) ve Negatif Dengesizlik Fiyatı (NDF) arasındaki sütunları seçmek için,</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">ptfsmf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(SMF<span class="op">:</span>NDF)</a></code></pre></div>
<pre><code>## # A tibble: 8,760 x 3
##      SMF   PDF   NDF
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1   5    4.85 103. 
##  2  95.0 92.2   99.6
##  3  79.6 77.2   84.0
##  4   0    0     39.7
##  5   0    0     11.9
##  6   0    0     11.5
##  7   0    0     11.5
##  8   0    0     25.1
##  9   0    0     35.5
## 10   0    0     46.6
## # … with 8,750 more rows</code></pre>
<p><code>rename</code> fonksiyonu ise adından da anlaşılabileceği üzere bir sütunun adını değiştirmek için kullanılır. Örneğin “PTF” sütununun ismini “ptf” olarak değiştirmek ve sonrasında bu sütunu seçmek istiyorsanız <code>rename</code> ve <code>select</code> fonksiyonlarını kullanabilirsiniz.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">ptfsmf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">ptf =</span> PTF) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="st">           </span><span class="kw">select</span>(ptf)</a></code></pre></div>
<pre><code>## # A tibble: 8,760 x 1
##      ptf
##    &lt;dbl&gt;
##  1 100. 
##  2  96.7
##  3  81.6
##  4  38.6
##  5  11.5
##  6  11.1
##  7  11.1
##  8  24.4
##  9  34.5
## 10  45.2
## # … with 8,750 more rows</code></pre>
</div>
<div id="filter" class="section level3">
<h3><span class="header-section-number">2.2.2</span> <code>filter</code></h3>
<p><code>filter</code> fonksiyonu temel olarak istenilen koşulları sağlayan satırları seçmek için kullanılır. Örneğin Piyasa Takas Fiyatı’nın 250’den düşük olduğu satırlar incelenebilir.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">ptfsmf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(PTF <span class="op">&lt;</span><span class="st"> </span><span class="dv">250</span>)</a></code></pre></div>
<pre><code>## # A tibble: 2,453 x 5
##    Tarih                 PTF   SMF   PDF   NDF
##    &lt;dttm&gt;              &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 2019-01-01 00:00:00 100.    5    4.85 103. 
##  2 2019-01-01 01:00:00  96.7  95.0 92.2   99.6
##  3 2019-01-01 02:00:00  81.6  79.6 77.2   84.0
##  4 2019-01-01 03:00:00  38.6   0    0     39.7
##  5 2019-01-01 04:00:00  11.5   0    0     11.9
##  6 2019-01-01 05:00:00  11.1   0    0     11.5
##  7 2019-01-01 06:00:00  11.1   0    0     11.5
##  8 2019-01-01 07:00:00  24.4   0    0     25.1
##  9 2019-01-01 08:00:00  34.5   0    0     35.5
## 10 2019-01-01 09:00:00  45.2   0    0     46.6
## # … with 2,443 more rows</code></pre>
<p>Gözlem sayısının 8670’ten 2453’e düştüğü görülebiliyor.</p>
<blockquote>
<p>Aynı şekilde bir değerin büyüklüğü <code>&gt;</code>, küçüklük veya eşitliği <code>&lt;=</code>, büyüklük veya eşitliği <code>&gt;=</code>, eşitliği ise <code>==</code> sembolleriyle incelenebilir.</p>
</blockquote>
<p>Birden fazla koşulun sağlanması gerekiyorsa ise, “VE” operatörü için <code>&amp;</code>, “VEYA” operatörü için <code>|</code>
sembolleri kullanılmalıdır. Örneğin Pozitif Dengesizlik Fiyatı’nın 200’den küçük, Negatif Dengesizlik Fiyatı’nın ise 200’den büyük olduğu satırlar incelenebilir.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">ptfsmf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(PDF<span class="op">&lt;</span><span class="dv">200</span> <span class="op">&amp;</span><span class="st"> </span>NDF<span class="op">&gt;</span><span class="dv">200</span>)</a></code></pre></div>
<pre><code>## # A tibble: 1,256 x 5
##    Tarih                 PTF   SMF   PDF   NDF
##    &lt;dttm&gt;              &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 2019-01-01 17:00:00  287.  172   167.  296.
##  2 2019-01-01 18:00:00  292.  172   167.  300.
##  3 2019-01-01 21:00:00  285.  173   168.  294.
##  4 2019-01-01 22:00:00  205.  173.  168.  211.
##  5 2019-01-02 07:00:00  288.  169.  164.  296.
##  6 2019-01-02 09:00:00  297.  173   168.  306.
##  7 2019-01-02 10:00:00  297.  190   184.  306.
##  8 2019-01-02 19:00:00  293.  190   184.  302.
##  9 2019-01-02 20:00:00  290.  173.  168.  299.
## 10 2019-01-02 21:00:00  289.  173.  168.  297.
## # … with 1,246 more rows</code></pre>
<p>Bu koşulları sağlayan 1256 satır olduğu görülüyor. Eğer bir koşulu sağlamayan satırlar aranıyorsa ise koşulun başına <code>!</code> yazılmasıyla bu ters etki taratılabilir. Örneğin Piyasa Takas Fiyatı’nın (PTF) 0’dan farklı olduğu satırları bulmak için,</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">ptfsmf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="op">!</span>(PTF<span class="op">==</span><span class="dv">0</span>))</a></code></pre></div>
<pre><code>## # A tibble: 8,708 x 5
##    Tarih                 PTF   SMF   PDF   NDF
##    &lt;dttm&gt;              &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 2019-01-01 00:00:00 100.    5    4.85 103. 
##  2 2019-01-01 01:00:00  96.7  95.0 92.2   99.6
##  3 2019-01-01 02:00:00  81.6  79.6 77.2   84.0
##  4 2019-01-01 03:00:00  38.6   0    0     39.7
##  5 2019-01-01 04:00:00  11.5   0    0     11.9
##  6 2019-01-01 05:00:00  11.1   0    0     11.5
##  7 2019-01-01 06:00:00  11.1   0    0     11.5
##  8 2019-01-01 07:00:00  24.4   0    0     25.1
##  9 2019-01-01 08:00:00  34.5   0    0     35.5
## 10 2019-01-01 09:00:00  45.2   0    0     46.6
## # … with 8,698 more rows</code></pre>
<p>Burada bu koşulu sağlayan 8706 satır olduğu görülüyor.</p>
</div>
<div id="arrange" class="section level3">
<h3><span class="header-section-number">2.2.3</span> <code>arrange</code></h3>
<p><code>arrange</code> fonksiyonu Excel’deki sıralama özelliğine benzetilebilir. Varsayılan durumunda A’dan Z’ye ya da küçükten büyüğe sıralanır. Tam tersi sıralama için <code>desc()</code> fonksiyonu kullanılmalıdır. Örneğin artan Piyasa Takas Fiyatlarına göre sıralamak için,</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1">ptfsmf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(PTF)</a></code></pre></div>
<pre><code>## # A tibble: 8,760 x 5
##    Tarih                 PTF   SMF   PDF   NDF
##    &lt;dttm&gt;              &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 2019-02-17 09:00:00     0    30     0 30.9 
##  2 2019-03-24 12:00:00     0     5     0  5.15
##  3 2019-03-24 13:00:00     0     0     0  0   
##  4 2019-03-24 14:00:00     0     0     0  0   
##  5 2019-03-24 15:00:00     0     0     0  0   
##  6 2019-03-24 16:00:00     0    10     0 10.3 
##  7 2019-04-14 09:00:00     0     0     0  0   
##  8 2019-04-14 10:00:00     0     0     0  0   
##  9 2019-04-14 13:00:00     0     0     0  0   
## 10 2019-04-14 14:00:00     0     0     0  0   
## # … with 8,750 more rows</code></pre>
<p>Bir başka örnekte Tarih, Pozitif Dengesizlik Fiyatı (PDF) ve Negatif Dengesizlik Farkı (NDF) sütunları seçilip azalan NDF’ye göre sıralanabilir.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1">ptfsmf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(Tarih, PDF, NDF) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb31-2" data-line-number="2"><span class="st">            </span><span class="kw">arrange</span>(<span class="kw">desc</span>(NDF))</a></code></pre></div>
<pre><code>## # A tibble: 8,760 x 3
##    Tarih                 PDF   NDF
##    &lt;dttm&gt;              &lt;dbl&gt; &lt;dbl&gt;
##  1 2019-06-27 15:00:00  436.  515 
##  2 2019-06-27 16:00:00  436.  515.
##  3 2019-06-27 14:00:00  454.  502.
##  4 2019-11-11 18:00:00  385.  502.
##  5 2019-06-26 11:00:00  303.  462.
##  6 2019-06-26 14:00:00  307.  450.
##  7 2019-11-11 17:00:00  370.  439.
##  8 2019-11-27 18:00:00  340.  433.
##  9 2019-07-09 15:00:00  373.  433.
## 10 2019-07-09 16:00:00  373.  433.
## # … with 8,750 more rows</code></pre>
<p>Dikkat edileceği üzere NDF değerleri azalarak devam ediyor. Ayrıca <code>arrange</code> fonksiyonunun içine birden fazla değer girerek ilk değerin eşitliği durumunda ikinci değerin karar vermesi sağlanabilir. Örneğin PTF değerinin 0 olduğu son gün aşağıdaki gibi bulunabilir.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1">ptfsmf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(Tarih, PTF) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb33-2" data-line-number="2"><span class="st">           </span><span class="kw">arrange</span>(PTF, <span class="kw">desc</span>(Tarih))</a></code></pre></div>
<pre><code>## # A tibble: 8,760 x 2
##    Tarih                 PTF
##    &lt;dttm&gt;              &lt;dbl&gt;
##  1 2019-06-06 09:00:00     0
##  2 2019-06-05 09:00:00     0
##  3 2019-06-04 16:00:00     0
##  4 2019-06-04 15:00:00     0
##  5 2019-06-04 14:00:00     0
##  6 2019-06-04 13:00:00     0
##  7 2019-06-04 12:00:00     0
##  8 2019-06-04 11:00:00     0
##  9 2019-06-04 10:00:00     0
## 10 2019-06-04 09:00:00     0
## # … with 8,750 more rows</code></pre>
<p>Bu durumda çıkan tabloya göz atıldığında çıkan ilk veri yıl içerisinde PTF’nin 0 olduğu son günü verecektir.</p>
</div>
<div id="mutatetransmute" class="section level3">
<h3><span class="header-section-number">2.2.4</span> <code>mutate</code>/<code>transmute</code></h3>
<p><code>mutate</code> fonksiyonu genellikle var olan değişkenlerle yapılan operasyonlar sonucu yeni değişkenler (sütunlar) yaratmak için kullanılır.</p>
<p>Örneğin yeni bir gün sütunu eklenmek istenirse (burada <code>lubridate</code> paketinin <code>as_date()</code> fonksiyonu kullanılmıştır.),</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1">ptfsmf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(Gün =<span class="st"> </span><span class="kw">as_date</span>(Tarih))</a></code></pre></div>
<pre><code>## # A tibble: 8,760 x 6
##    Tarih                 PTF   SMF   PDF   NDF Gün       
##    &lt;dttm&gt;              &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;date&gt;    
##  1 2019-01-01 00:00:00 100.    5    4.85 103.  2019-01-01
##  2 2019-01-01 01:00:00  96.7  95.0 92.2   99.6 2019-01-01
##  3 2019-01-01 02:00:00  81.6  79.6 77.2   84.0 2019-01-01
##  4 2019-01-01 03:00:00  38.6   0    0     39.7 2019-01-01
##  5 2019-01-01 04:00:00  11.5   0    0     11.9 2019-01-01
##  6 2019-01-01 05:00:00  11.1   0    0     11.5 2019-01-01
##  7 2019-01-01 06:00:00  11.1   0    0     11.5 2019-01-01
##  8 2019-01-01 07:00:00  24.4   0    0     25.1 2019-01-01
##  9 2019-01-01 08:00:00  34.5   0    0     35.5 2019-01-01
## 10 2019-01-01 09:00:00  45.2   0    0     46.6 2019-01-01
## # … with 8,750 more rows</code></pre>
<p>Veya <a href="index.html#veri-setine-ilk-bakış">Veri Setine İlk Bakış</a> bölümünde anlatıldığı üzere Pozitif Dengesizlik Fiyatı (PDF) hesaplanmak istenirse,</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1">ptfsmf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">PDF_Yeni =</span> <span class="kw">ifelse</span>(PTF<span class="op">&lt;</span>SMF, <span class="fl">0.97</span><span class="op">*</span>PTF, <span class="fl">0.97</span><span class="op">*</span>SMF))</a></code></pre></div>
<pre><code>## # A tibble: 8,760 x 6
##    Tarih                 PTF   SMF   PDF   NDF PDF_Yeni
##    &lt;dttm&gt;              &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
##  1 2019-01-01 00:00:00 100.    5    4.85 103.      4.85
##  2 2019-01-01 01:00:00  96.7  95.0 92.2   99.6    92.2 
##  3 2019-01-01 02:00:00  81.6  79.6 77.2   84.0    77.2 
##  4 2019-01-01 03:00:00  38.6   0    0     39.7     0   
##  5 2019-01-01 04:00:00  11.5   0    0     11.9     0   
##  6 2019-01-01 05:00:00  11.1   0    0     11.5     0   
##  7 2019-01-01 06:00:00  11.1   0    0     11.5     0   
##  8 2019-01-01 07:00:00  24.4   0    0     25.1     0   
##  9 2019-01-01 08:00:00  34.5   0    0     35.5     0   
## 10 2019-01-01 09:00:00  45.2   0    0     46.6     0   
## # … with 8,750 more rows</code></pre>
<p>Dikkat edileceği üzere “PDF_Yeni” ve “PDF” sütunları aynı değerleri gösteriyor. Burada temel R fonksiyonlarının <code>mutate</code> içerisindeki kullanımına dikkat edilmelidir.</p>
<blockquote>
<p>Burada <a href="index.html#veri-setine-ilk-bakış">Veri Setine İlk Bakış</a> kısmında anlatıldığı üzere Pozitif Dengesizlik Fiyatı (PDF) hesaplamak için <code>ifelse</code> fonksiyonu kullanılmıştır. Burada temel olarak yapılan işlem şudur: <code>PTF&lt;SMF</code> koşulu doğruysa ilk denklemi (<code>0.97*PTF</code>) uygula, değilse ikinci denklemi (<code>0.97*SMF</code>) uygula.</p>
</blockquote>
<p><code>transmute</code> fonksiyonu da <code>mutate</code> fonksiyonu ile benzer bir işleve sahip olmasının yanında <code>select</code> fonksiyonunun belirli sütunları seçme işlevine de sahiptir. Örneğin <code>lubridate</code> paketinin <code>as_date()</code> fonksiyonunu kullanarak yeni bir “Gün” sütunu açıp “PTF” ve “SMF” sütunlarını da seçmek ve azalan PTF’ye göre sıralamak için,</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1">ptfsmf <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb39-2" data-line-number="2"><span class="st">  </span><span class="kw">transmute</span>(PTF, SMF, Gün =<span class="st"> </span><span class="kw">as_date</span>(Tarih)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb39-3" data-line-number="3"><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(PTF))</a></code></pre></div>
<pre><code>## # A tibble: 8,760 x 3
##      PTF   SMF Gün       
##    &lt;dbl&gt; &lt;dbl&gt; &lt;date&gt;    
##  1  500   450  2019-06-27
##  2  500.  450  2019-06-27
##  3  488.  468. 2019-06-27
##  4  401.  401. 2019-06-27
##  5  400.  400. 2019-06-12
##  6  400.  400. 2019-06-12
##  7  400.  400. 2019-06-12
##  8  397.  487. 2019-11-11
##  9  385   415  2019-07-09
## 10  385   420. 2019-07-09
## # … with 8,750 more rows</code></pre>
</div>
<div id="group_bysummarise" class="section level3">
<h3><span class="header-section-number">2.2.5</span> <code>group_by</code>/<code>summarise</code></h3>
<p>Bu iki fonksiyon çoğunlukla özetleme tabloları çıkarmak için kullanılır. <code>group_by</code> sütunlara göre veriyi gruplamak, <code>summarise</code> ise gruplanan bu verilere göre istenen özeti çıkarmakla görevlidir. Örneğin günlük ortalama PTF fiyat bilgisi için,</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1">ptfsmf <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb41-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(Gün =<span class="st"> </span><span class="kw">as_date</span>(Tarih)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb41-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(Gün) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb41-4" data-line-number="4"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">Gunluk_Ort_PTF =</span> <span class="kw">mean</span>(PTF))</a></code></pre></div>
<pre><code>## # A tibble: 365 x 2
##    Gün        Gunluk_Ort_PTF
##    &lt;date&gt;              &lt;dbl&gt;
##  1 2019-01-01           121.
##  2 2019-01-02           229.
##  3 2019-01-03           239.
##  4 2019-01-04           212.
##  5 2019-01-05           244.
##  6 2019-01-06           237.
##  7 2019-01-07           247.
##  8 2019-01-08           248.
##  9 2019-01-09           220.
## 10 2019-01-10           163.
## # … with 355 more rows</code></pre>
<blockquote>
<p>Burada kullanılan <code>mean</code> fonksiyonu dışında maksimum değer için <code>max</code>, minimum değer için <code>min</code>, medyan için <code>median</code>, total değer için <code>sum</code> ve grupladığımız değişkene ait gözlem sayısını saymak için ise <code>n()</code>fonksiyonları kullanılabilir.</p>
</blockquote>
</div>
<div id="distinct" class="section level3">
<h3><span class="header-section-number">2.2.6</span> <code>distinct</code></h3>
<p><code>distinct</code> fonksiyonu bir veya birden fazla sütunu baz alarak özgün satırları bulmak için kullanılır. Örneğin var olan tabloda bir “Gün” sütunu var ve her güne dair yalnızca bir değer incelenmek isteniyor. Bu durumdan kurtulmak için <code>distinct</code> fonksiyonu kullanılabilir. Örneğin,</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1">ptfsmf <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb43-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(Gün =<span class="st"> </span><span class="kw">as_date</span>(Tarih)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb43-3" data-line-number="3"><span class="st">  </span><span class="kw">distinct</span>(Gün)</a></code></pre></div>
<pre><code>## # A tibble: 365 x 1
##    Gün       
##    &lt;date&gt;    
##  1 2019-01-01
##  2 2019-01-02
##  3 2019-01-03
##  4 2019-01-04
##  5 2019-01-05
##  6 2019-01-06
##  7 2019-01-07
##  8 2019-01-08
##  9 2019-01-09
## 10 2019-01-10
## # … with 355 more rows</code></pre>
<p>Dikkat edileceği üzere yalnızca Gün sütunu korundu. Diğer sütunları da korumak için <code>.keep_all = TRUE</code> komutu kullanılmalıdır.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1">ptfsmf <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb45-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(Gün =<span class="st"> </span><span class="kw">as_date</span>(Tarih)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb45-3" data-line-number="3"><span class="st">  </span><span class="kw">distinct</span>(Gün, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## # A tibble: 365 x 6
##    Tarih                  PTF   SMF    PDF    NDF Gün       
##    &lt;dttm&gt;               &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;date&gt;    
##  1 2019-01-01 00:00:00 100.     5     4.85 103.   2019-01-01
##  2 2019-01-02 00:00:00 105.   103.   99.9  108.   2019-01-02
##  3 2019-01-03 00:00:00 126.    52    50.4  130.   2019-01-03
##  4 2019-01-04 00:00:00 104.    50    48.5  107.   2019-01-04
##  5 2019-01-05 00:00:00 178.   100    97    184.   2019-01-05
##  6 2019-01-06 00:00:00 286.   271   263.   294.   2019-01-06
##  7 2019-01-07 00:00:00 200.   100.   97.1  206.   2019-01-07
##  8 2019-01-08 00:00:00 199.   120   116.   205.   2019-01-08
##  9 2019-01-09 00:00:00 199.    98.8  95.8  205.   2019-01-09
## 10 2019-01-10 00:00:00   4.42   0.1   0.1    4.55 2019-01-10
## # … with 355 more rows</code></pre>
<p>Burada gözlem sayısının 365’e düştüğüne dikkat edilmelidir.</p>
</div>
</div>
<div id="örnekler" class="section level2">
<h2><span class="header-section-number">2.3</span> Örnekler</h2>
<p>Bu bölümde, kolaydan zora örnekler ele alınacak ve <code>dplyr</code> paketi daha da pekiştirilmeye çalışılacaktır. Soruların cevapları hemen soruların altında olacaktır ancak cevaplara göz atmadan önce soruları çözmeye çalışmanızı şiddetle tavsiye ediyoruz.</p>
<blockquote>
<p>Devamlı bir gelişim gösteren kitabımıza yeni örnekler eklemeyi sürdüreceğiz.</p>
</blockquote>
<div id="basit-seviye" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Basit Seviye</h3>
<p><strong>1. Piyasa Takas Fiyatı (PTF) verisinin aylık ortalama, medyan, maksimum ve minimum değerlerini bulunuz.</strong></p>
<p><strong>İpucu: <code>lubridate</code> paketinin <code>month()</code> fonksiyonunu kullanabilirsiniz.</strong></p>
<p>Sonuç olarak şu şekilde bir tablo ortaya çıkmalı,</p>
<pre><code>## # A tibble: 12 x 5
##       Ay   ORT   MED  MAKS   MIN
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1     1  223.  258.  327.  0.5 
##  2     2  257.  275.  330.  0   
##  3     3  256.  296.  332.  0   
##  4     4  187.  200.  309.  0   
##  5     5  196.  220.  317.  0   
##  6     6  221.  275.  500   0   
##  7     7  305.  315.  385  50.0 
##  8     8  298.  310.  330.  0.99
##  9     9  298.  307.  325. 45   
## 10    10  292.  309.  338  10   
## 11    11  298.  313.  397. 50   
## 12    12  291.  314.  338. 45.0</code></pre>
<p>Cevap ise şu şekilde,</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1">ptfsmf <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb48-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Ay=</span><span class="kw">month</span>(Tarih)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb48-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(Ay) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb48-4" data-line-number="4"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">ORT =</span> <span class="kw">mean</span>(PTF), <span class="dt">MED =</span> <span class="kw">median</span>(PTF), <span class="dt">MAKS =</span> <span class="kw">max</span>(PTF), <span class="dt">MIN =</span> <span class="kw">min</span>(PTF))</a></code></pre></div>
<p><strong>2. Yaz aylarının (Haziran, Temmuz, Ağustos ayları) akşam saatlerinde (18-22 arası, bu değerler dahil olmak üzere) ortaya çıkan günlük toplam NDF değerlerini bulunuz.</strong></p>
<p><strong>İpucu: Saatleri bulmak için <code>lubridate</code> paketinin <code>hour()</code> fonksiyonunu, tarihi güne çevirmek için ise yine aynı paketten <code>as_date()</code> fonksiyonunu kullanabilirsiniz.</strong></p>
<p>Sonuç olarak şu şekilde bir tablo ortaya çıkmalı,</p>
<pre><code>## # A tibble: 92 x 2
##    Tarih        NDF
##    &lt;date&gt;     &lt;dbl&gt;
##  1 2019-06-01 1957 
##  2 2019-06-02 1849.
##  3 2019-06-03 1516.
##  4 2019-06-04  726.
##  5 2019-06-05 1103.
##  6 2019-06-06 1496.
##  7 2019-06-07 1646.
##  8 2019-06-08 1513.
##  9 2019-06-09 1117.
## 10 2019-06-10 1558.
## # … with 82 more rows</code></pre>
<p>Cevap ise şu şekilde,</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1">ptfsmf <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb50-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Saat=</span><span class="kw">hour</span>(Tarih), <span class="dt">Tarih=</span><span class="kw">as_date</span>(Tarih)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb50-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>((Tarih <span class="op">&gt;=</span><span class="st"> &quot;2019-06-01&quot;</span> <span class="op">&amp;</span><span class="st"> </span>Tarih <span class="op">&lt;=</span><span class="st"> &quot;2019-08-31&quot;</span>), (Saat <span class="op">&gt;=</span><span class="st"> </span><span class="dv">18</span> <span class="op">&amp;</span><span class="st"> </span>Saat <span class="op">&lt;=</span><span class="st"> </span><span class="dv">22</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb50-4" data-line-number="4"><span class="st">  </span><span class="kw">select</span>(Tarih, Saat, NDF) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb50-5" data-line-number="5"><span class="st">  </span><span class="kw">group_by</span>(Tarih) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb50-6" data-line-number="6"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">NDF =</span> <span class="kw">sum</span>(NDF))</a></code></pre></div>
</div>
<div id="ileri-seviye" class="section level3">
<h3><span class="header-section-number">2.3.2</span> İleri Seviye</h3>
<p><strong>1. SMF/PTF oranının aylara göre en yüksek olduğu üçer gözlemi bulunuz.</strong></p>
<p><strong>İpucu: İstediğiniz sayıda satırı seçmek için <code>slice()</code> fonksiyonunu kullanabilirsiniz. <code>slice()</code> fonksiyonunun kullanımı için <a href="https://rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf" target="_blank">dplyr Cheatsheet</a> dökümanına göz atılabilir.</strong></p>
<p>Sonuç olarak şu şekilde bir tablo ortaya çıkmalı,</p>
<pre><code>## # A tibble: 36 x 3
##    Tarih                  Ay SMF_PTF_Orani
##    &lt;dttm&gt;              &lt;dbl&gt;         &lt;dbl&gt;
##  1 2019-01-13 16:00:00     1          2.03
##  2 2019-01-28 04:00:00     1          1.71
##  3 2019-01-13 11:00:00     1          1.53
##  4 2019-02-24 13:00:00     2         51.3 
##  5 2019-02-10 09:00:00     2         28.4 
##  6 2019-02-24 15:00:00     2         18.6 
##  7 2019-03-24 17:00:00     3         15.5 
##  8 2019-03-29 23:00:00     3         15.3 
##  9 2019-03-24 18:00:00     3          8.25
## 10 2019-04-21 12:00:00     4        100   
## # … with 26 more rows</code></pre>
<p>Cevap ise şu şekilde,</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1">ptfsmf <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb52-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span>(PTF <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb52-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Ay =</span> <span class="kw">month</span>(Tarih)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb52-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">SMF_PTF_Orani =</span> SMF <span class="op">/</span><span class="st"> </span>PTF) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb52-5" data-line-number="5"><span class="st">  </span><span class="kw">group_by</span>(Ay) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb52-6" data-line-number="6"><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(SMF_PTF_Orani)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb52-7" data-line-number="7"><span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb52-8" data-line-number="8"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb52-9" data-line-number="9"><span class="st">  </span><span class="kw">select</span>(Tarih, Ay, SMF_PTF_Orani)</a></code></pre></div>
<blockquote>
<p>Burada önemli olan bir nokta, <code>group_by()</code> fonksiyonu ile gruplanmış bir tablo ile farklı işlemlere devam edilmek isteniyorsa hata alınmaması amacıyla <code>ungroup()</code> fonksiyonunun kullanılması gerektiğidir.</p>
</blockquote>
<p><strong>2. Her bir günün ortalama PTF değerlerleri ile birlikte yeni bir sütunda tam bir hafta önceki ortalama PTF değerini gösteriniz.</strong></p>
<p><strong>İpucu: Haftanın günlerini çıkarmak için <code>R</code>’ın kendi fonksiyonu olan <code>weekdays()</code> fonksiyonunu, tabloda kaydırma yapmak için ise <code>dplyr</code> paketinin <code>lag()</code> fonksiyonu kullanılabilir.</strong></p>
<p>Sonuç olarak şu şekilde bir tablo ortaya çıkmalı (İlk 7 günün geçmiş verisi olmadığından o satırlar <code>slice()</code> fonksiyonu yardımıyla silinmiştir.),</p>
<pre><code>## # A tibble: 716 x 4
##    Tarih      Gün       PTF_Degisim    PTF_Degerleri
##    &lt;date&gt;     &lt;chr&gt;     &lt;chr&gt;                  &lt;dbl&gt;
##  1 2019-01-08 Tuesday   ÖncekiHaftaPTF          121.
##  2 2019-01-08 Tuesday   PTF                     248.
##  3 2019-01-09 Wednesday ÖncekiHaftaPTF          229.
##  4 2019-01-09 Wednesday PTF                     220.
##  5 2019-01-10 Thursday  ÖncekiHaftaPTF          239.
##  6 2019-01-10 Thursday  PTF                     163.
##  7 2019-01-11 Friday    ÖncekiHaftaPTF          212.
##  8 2019-01-11 Friday    PTF                     180.
##  9 2019-01-12 Saturday  ÖncekiHaftaPTF          244.
## 10 2019-01-12 Saturday  PTF                     237.
## # … with 706 more rows</code></pre>
<p>Cevap ise şu şekilde,</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1">ptfsmf <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb54-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Tarih =</span> <span class="kw">as_date</span>(Tarih)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb54-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(Tarih) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb54-4" data-line-number="4"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">PTF =</span> <span class="kw">mean</span>(PTF)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb54-5" data-line-number="5"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb54-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(Gün =<span class="st"> </span><span class="kw">weekdays</span>(Tarih)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb54-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(Ö<span class="dt">ncekiHaftaPTF =</span> <span class="kw">lag</span>(<span class="dt">x =</span> PTF, <span class="dt">n =</span> <span class="dv">7</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb54-8" data-line-number="8"><span class="st">  </span><span class="kw">select</span>(Tarih, Gün, ÖncekiHaftaPTF, PTF) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb54-9" data-line-number="9"><span class="st">  </span><span class="kw">slice</span>(<span class="dv">8</span><span class="op">:</span><span class="kw">n</span>()) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb54-10" data-line-number="10"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols=</span><span class="kw">c</span>(ÖncekiHaftaPTF, PTF), <span class="dt">names_to=</span><span class="st">&quot;PTF_Degisim&quot;</span>,</a>
<a class="sourceLine" id="cb54-11" data-line-number="11">               <span class="dt">values_to=</span><span class="st">&quot;PTF_Degerleri&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb54-12" data-line-number="12"><span class="st">  </span><span class="kw">arrange</span>(Tarih)</a></code></pre></div>
<p>Burada <code>tidyr</code> paketinin <code>pivot_longer()</code> fonksiyonu bulunuyor. Bu fonksiyon temel olarak geniş tabloları belirli sütunlarını bir ortak sütun içerisinde birleştirip bunu yaparken de satır sayısını birleştirilen sütun sayısı oranında artıran bir fonksiyondur.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ggplot2-ile-veri-görselleştirme.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["book.pdf", "PDF"], ["book.epub", "EPUB"]],
"toc": {
"collapse": "none",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": true,
"info": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
