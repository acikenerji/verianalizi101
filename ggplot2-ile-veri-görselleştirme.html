<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 ggplot2 ile Veri Görselleştirme | R İLE ENERJİ PİYASASI VERİ ANALİZİ EL KİTABI</title>
  <meta name="description" content="3 ggplot2 ile Veri Görselleştirme | R İLE ENERJİ PİYASASI VERİ ANALİZİ EL KİTABI" />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="3 ggplot2 ile Veri Görselleştirme | R İLE ENERJİ PİYASASI VERİ ANALİZİ EL KİTABI" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 ggplot2 ile Veri Görselleştirme | R İLE ENERJİ PİYASASI VERİ ANALİZİ EL KİTABI" />
  
  
  

<meta name="author" content="" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="dplyr-ile-veri-manipülasyonu.html"/>
<link rel="next" href="ekler.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Giriş</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#amaç"><i class="fa fa-check"></i><b>1.1</b> Amaç</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#kurulum"><i class="fa fa-check"></i><b>1.2</b> Kurulum</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#r-ve-rstudionun-indirilmesi"><i class="fa fa-check"></i><b>1.2.1</b> R ve RStudio’nun İndirilmesi</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#kurulumun-test-edilmesi"><i class="fa fa-check"></i><b>1.2.2</b> Kurulumun Test Edilmesi</a></li>
<li class="chapter" data-level="1.2.3" data-path="index.html"><a href="index.html#rstudio-cloud"><i class="fa fa-check"></i><b>1.2.3</b> RStudio Cloud</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#veriseti"><i class="fa fa-check"></i><b>1.3</b> Dökümanda Kullanılan Veri Seti</a><ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#veri-setine-ilk-bakış"><i class="fa fa-check"></i><b>1.3.1</b> Veri Setine İlk Bakış</a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#veri-setinin-indirilmesi"><i class="fa fa-check"></i><b>1.3.2</b> Veri Setinin İndirilmesi</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="dplyr-ile-veri-manipülasyonu.html"><a href="dplyr-ile-veri-manipülasyonu.html"><i class="fa fa-check"></i><b>2</b> dplyr ile Veri Manipülasyonu</a><ul>
<li class="chapter" data-level="2.1" data-path="dplyr-ile-veri-manipülasyonu.html"><a href="dplyr-ile-veri-manipülasyonu.html#hazırlıklar"><i class="fa fa-check"></i><b>2.1</b> Hazırlıklar</a></li>
<li class="chapter" data-level="2.2" data-path="dplyr-ile-veri-manipülasyonu.html"><a href="dplyr-ile-veri-manipülasyonu.html#önemli-fonksiyonlar"><i class="fa fa-check"></i><b>2.2</b> Önemli Fonksiyonlar</a><ul>
<li class="chapter" data-level="2.2.1" data-path="dplyr-ile-veri-manipülasyonu.html"><a href="dplyr-ile-veri-manipülasyonu.html#selectrename"><i class="fa fa-check"></i><b>2.2.1</b> <code>select</code>/<code>rename</code></a></li>
<li class="chapter" data-level="2.2.2" data-path="dplyr-ile-veri-manipülasyonu.html"><a href="dplyr-ile-veri-manipülasyonu.html#filter"><i class="fa fa-check"></i><b>2.2.2</b> <code>filter</code></a></li>
<li class="chapter" data-level="2.2.3" data-path="dplyr-ile-veri-manipülasyonu.html"><a href="dplyr-ile-veri-manipülasyonu.html#arrange"><i class="fa fa-check"></i><b>2.2.3</b> <code>arrange</code></a></li>
<li class="chapter" data-level="2.2.4" data-path="dplyr-ile-veri-manipülasyonu.html"><a href="dplyr-ile-veri-manipülasyonu.html#mutatetransmute"><i class="fa fa-check"></i><b>2.2.4</b> <code>mutate</code>/<code>transmute</code></a></li>
<li class="chapter" data-level="2.2.5" data-path="dplyr-ile-veri-manipülasyonu.html"><a href="dplyr-ile-veri-manipülasyonu.html#group_bysummarise"><i class="fa fa-check"></i><b>2.2.5</b> <code>group_by</code>/<code>summarise</code></a></li>
<li class="chapter" data-level="2.2.6" data-path="dplyr-ile-veri-manipülasyonu.html"><a href="dplyr-ile-veri-manipülasyonu.html#distinct"><i class="fa fa-check"></i><b>2.2.6</b> <code>distinct</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ggplot2-ile-veri-görselleştirme.html"><a href="ggplot2-ile-veri-görselleştirme.html"><i class="fa fa-check"></i><b>3</b> ggplot2 ile Veri Görselleştirme</a><ul>
<li class="chapter" data-level="3.1" data-path="ggplot2-ile-veri-görselleştirme.html"><a href="ggplot2-ile-veri-görselleştirme.html#hazırlıklar-1"><i class="fa fa-check"></i><b>3.1</b> Hazırlıklar</a></li>
<li class="chapter" data-level="3.2" data-path="ggplot2-ile-veri-görselleştirme.html"><a href="ggplot2-ile-veri-görselleştirme.html#nokta-grafiği-scatter-plot"><i class="fa fa-check"></i><b>3.2</b> Nokta Grafiği (Scatter Plot)</a></li>
<li class="chapter" data-level="3.3" data-path="ggplot2-ile-veri-görselleştirme.html"><a href="ggplot2-ile-veri-görselleştirme.html#sütunlu-grafik-bar-chart"><i class="fa fa-check"></i><b>3.3</b> Sütunlu Grafik (Bar Chart)</a></li>
<li class="chapter" data-level="3.4" data-path="ggplot2-ile-veri-görselleştirme.html"><a href="ggplot2-ile-veri-görselleştirme.html#çizgi-grafiği-line-chart"><i class="fa fa-check"></i><b>3.4</b> Çizgi Grafiği (Line Chart)</a></li>
<li class="chapter" data-level="3.5" data-path="ggplot2-ile-veri-görselleştirme.html"><a href="ggplot2-ile-veri-görselleştirme.html#isı-harıtası-heat-map"><i class="fa fa-check"></i><b>3.5</b> Isı Harıtası (Heat Map)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ekler.html"><a href="ekler.html"><i class="fa fa-check"></i>Ekler</a><ul>
<li class="chapter" data-level="" data-path="ekler.html"><a href="ekler.html#yazarlar-hakkında"><i class="fa fa-check"></i>Yazarlar Hakkında</a></li>
<li class="chapter" data-level="" data-path="ekler.html"><a href="ekler.html#rstudio-cloudda-çalışma"><i class="fa fa-check"></i>RStudio Cloud’da Çalışma</a></li>
<li class="chapter" data-level="" data-path="ekler.html"><a href="ekler.html#veri-seti-düzenlemeleri"><i class="fa fa-check"></i>Veri Seti Düzenlemeleri</a></li>
<li class="chapter" data-level="" data-path="ekler.html"><a href="ekler.html#kaynakça"><i class="fa fa-check"></i>Kaynakça</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R İLE ENERJİ PİYASASI VERİ ANALİZİ EL KİTABI</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ggplot2-ile-veri-görselleştirme" class="section level1">
<h1><span class="header-section-number">3</span> ggplot2 ile Veri Görselleştirme</h1>
<p>Bu bölümde <code>ggplot2</code> paketinden yararlanarak veri görselleştirmenin nasıl yapılabileceği farklı fonksiyonlar ve örnekler üzerinden gösterilecektir.</p>
<div id="hazırlıklar-1" class="section level2">
<h2><span class="header-section-number">3.1</span> Hazırlıklar</h2>
<p>Bu bölüme başlamadan önce yapılması gereken <code>ggplot2</code> paketini indirmek ve yüklemek. Paketi indirmek için <code>install.packages(&quot;ggplot2&quot;)</code> , paketi yüklemek için ise <code>library(ggplot2)</code> komutları kullanılabilir. (Veri setini indirmediyseniz lütfen <a href="index.html#veriseti">Veri Seti</a> bölümünü ziyaret ediniz.)</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="co"># ggplot2 paketinin indirilmesi</span></a>
<a class="sourceLine" id="cb36-2" data-line-number="2"><span class="kw">install.packages</span>(<span class="st">&quot;ggplot2&quot;</span>)</a>
<a class="sourceLine" id="cb36-3" data-line-number="3"><span class="co"># ggplot2 paketinin yüklenmesi</span></a>
<a class="sourceLine" id="cb36-4" data-line-number="4"><span class="kw">library</span>(ggplot2)</a></code></pre></div>
<!-- Bu bölümde daha ayrıntılı renklendirmelerin nasıl yapılabileceğinin gösterilebilmesi adına veri seti üzerinde bazı düzenlemeler gerekiyor. Örneğin 2019 Haziran ayı için saatlere göre Piyasa Takas Fiyatı (PTF) ve Sistem Marjinal Fiyatı (SMF) incelenecek olursa (Dönüşüm aşamasında kullanılan `pivot_longer` fonksiyonu, bu dökümanın kapsamı dışında olduğundan burada açıklanmayacaktır.), -->
<!-- ```{r} -->
<!-- plot_df <- ptfsmf %>% mutate(Saat = hour(Tarih), Tarih = as.Date(Tarih)) %>% -->
<!--                       filter(Tarih>"2019-05-31" & Tarih<"2019-07-01") %>% -->
<!--                       group_by(Saat) %>% -->
<!--                       summarise(PTF = mean(PTF), SMF = mean(SMF)) %>% -->
<!--                       ungroup() %>% -->
<!--                       pivot_longer(cols=PTF:SMF, names_to="Piyasa_Degiskeni", values_to="Fiyatlar") %>% -->
<!--                       glimpse() -->
<!-- ``` -->
<!-- Bu dönüşümleri uygulamadan bu bölümde kullanılacak olan veri setine erişmek isterseniz aşağıda gördüğünüz kodu çalıştırabilirsiniz. -->
<!-- ```{r} -->
<!-- # plot datasini rds olarak indirebilecekleri kod -->
<!-- ``` -->
<p><code>dplyr</code> paketinde birden fazla fonksiyonu aynı veri setine uygulamak için “Bağlantı Operatörü” (<code>%&gt;%</code>) kullanılırken <code>ggplot2</code> paketinde ise birden fazla etkiyi aynı ayna uygulamak için (<code>+</code>) operatörü kullanılıyor. Bu durum başlangıç grafiğinin üzerine farklı görseller eklenmesi olarak düşünülebilir.</p>
</div>
<div id="nokta-grafiği-scatter-plot" class="section level2">
<h2><span class="header-section-number">3.2</span> Nokta Grafiği (Scatter Plot)</h2>
<p>İlk olarak bahsedilecek grafik türü olan “Scatter Plot” temel olarak var olan verinin noktasal dağılımını göstermek için kullanılır. Burada <code>ggplot</code> fonksiyonu ile de ilk kez karşılaşıldığından bazı özelliklerinden bahsedilmelidir. Fonksiyonun içine ilk yazılan parametre kullanılacak verinin ismidir. Daha sonra <code>aes()</code> yardımıyla grafiğin x ve y koordinatları belirlenir. <code>aes()</code> içerisinde ayrıca <code>color</code>, <code>fill</code>, <code>alpha</code>, <code>shape</code>, <code>size</code> gibi özellikler de belirlenebilir.</p>
<p>“Scatter Plot” için kullanılan fonksiyon ise <code>geom_point()</code>tir. “x” ekseninde “PTF”, “y” ekseninde ise “SMF” değerleri renkleri günlere göre değişecek şekilde gösterilirse (Öncelikle gün sütunu ekleniyor.),</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1">ptfsmf &lt;-<span class="st"> </span>ptfsmf <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-2" data-line-number="2"><span class="st">            </span><span class="kw">mutate</span>(<span class="dt">Gun =</span> <span class="kw">as_date</span>(Tarih))</a></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="kw">ggplot</span>(ptfsmf, <span class="kw">aes</span>(<span class="dt">x=</span>PTF, <span class="dt">y=</span>SMF, <span class="dt">color=</span>Gun)) <span class="op">+</span></a>
<a class="sourceLine" id="cb38-2" data-line-number="2"><span class="st">            </span><span class="kw">geom_point</span>()</a></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<p>Görülebileceği üzere öncelikle veri seti, sonrasında ise <code>aes()</code> içerisinde x ve koordinatları ile renk belirlendi.</p>
<p>Grafiği görsel olarak daha güzel hale getirmek için öncelikle arka plandaki gri kısım <code>theme_minimal()</code> fonksiyonu yardımıyla kaldırılabilir.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="kw">ggplot</span>(ptfsmf, <span class="kw">aes</span>(<span class="dt">x=</span>PTF, <span class="dt">y=</span>SMF, <span class="dt">color=</span>Gun)) <span class="op">+</span></a>
<a class="sourceLine" id="cb39-2" data-line-number="2"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb39-3" data-line-number="3"><span class="st">    </span><span class="kw">theme_minimal</span>()</a></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<p>Grafiğin ve eksenlerinin ismini değiştirmek, x eksenindeki yazıları döndürmek ve lejantı istenilen şekilde konumlamak için aşağıdakiler uygulanmalıdır.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="kw">ggplot</span>(ptfsmf, <span class="kw">aes</span>(<span class="dt">x=</span>PTF, <span class="dt">y=</span>SMF, <span class="dt">color=</span>Gun)) <span class="op">+</span></a>
<a class="sourceLine" id="cb40-2" data-line-number="2"><span class="st">            </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb40-3" data-line-number="3"><span class="st">            </span><span class="kw">theme_minimal</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb40-4" data-line-number="4"><span class="st">            </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;PTF&quot;</span>,</a>
<a class="sourceLine" id="cb40-5" data-line-number="5">                 <span class="dt">y =</span> <span class="st">&quot;SMF&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb40-6" data-line-number="6"><span class="st">            </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>), <span class="dt">legend.position =</span> <span class="st">&quot;top&quot;</span>, </a>
<a class="sourceLine" id="cb40-7" data-line-number="7">                  <span class="dt">legend.title =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
</div>
<div id="sütunlu-grafik-bar-chart" class="section level2">
<h2><span class="header-section-number">3.3</span> Sütunlu Grafik (Bar Chart)</h2>
<p>“Bar Chart”ta ise veriler sütunlarda gösterilir. “Scatter Plot”taki <code>geom_point()</code> yerine <code>geom_bar()</code> fonksiyonu, <code>aes()</code> içerisinde <code>color</code> yerine ise <code>fill</code> kullanılır. (Burada <code>geom_bar</code> içerisinde <code>stat=&quot;identity&quot;</code> yazılması zorunludur.)</p>
<p>Örneğin Negatif Dengesizlik Fiyatı’nın ne kadarının PTF’den ne kadarının ceza payından geldiği Haziran ayı için saatlere göre incelenmek isteniyorsa (Öncelikle veri manipülasyonu gerçekleştiriliyor.),</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1">plot_df &lt;-<span class="st"> </span>ptfsmf <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb41-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Saat =</span> <span class="kw">hour</span>(Tarih), <span class="dt">Tarih =</span> <span class="kw">as.Date</span>(Tarih), <span class="dt">Fark_NDF_PTF =</span> NDF <span class="op">-</span><span class="st"> </span>PTF) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb41-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(Tarih<span class="op">&gt;</span><span class="st">&quot;2019-05-31&quot;</span> <span class="op">&amp;</span><span class="st"> </span>Tarih<span class="op">&lt;</span><span class="st">&quot;2019-07-01&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb41-4" data-line-number="4"><span class="st">  </span><span class="kw">group_by</span>(Saat) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb41-5" data-line-number="5"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">PTF =</span> <span class="kw">mean</span>(PTF), <span class="dt">Fark_NDF_PTF =</span> <span class="kw">mean</span>(Fark_NDF_PTF)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb41-6" data-line-number="6"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb41-7" data-line-number="7"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols=</span><span class="kw">c</span>(PTF, Fark_NDF_PTF), </a>
<a class="sourceLine" id="cb41-8" data-line-number="8">               <span class="dt">names_to=</span><span class="st">&quot;Piyasa_Degiskeni&quot;</span>, <span class="dt">values_to=</span><span class="st">&quot;Fiyatlar&quot;</span>)</a>
<a class="sourceLine" id="cb41-9" data-line-number="9">plot_df</a></code></pre></div>
<pre><code>## # A tibble: 48 x 3
##     Saat Piyasa_Degiskeni Fiyatlar
##    &lt;int&gt; &lt;chr&gt;               &lt;dbl&gt;
##  1     0 PTF                 231. 
##  2     0 Fark_NDF_PTF         12.4
##  3     1 PTF                 253. 
##  4     1 Fark_NDF_PTF         20.2
##  5     2 PTF                 237. 
##  6     2 Fark_NDF_PTF         17.4
##  7     3 PTF                 205. 
##  8     3 Fark_NDF_PTF         13.6
##  9     4 PTF                 186. 
## 10     4 Fark_NDF_PTF         17.4
## # … with 38 more rows</code></pre>
<p>Bu şekilde bir tablo ortaya çıktı. Şimdi grafiği çizdirmek için,</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="kw">ggplot</span>(plot_df, <span class="kw">aes</span>(<span class="dt">x=</span>Saat, <span class="dt">y=</span>Fiyatlar, <span class="dt">fill=</span>Piyasa_Degiskeni)) <span class="op">+</span></a>
<a class="sourceLine" id="cb43-2" data-line-number="2"><span class="st">            </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>)</a></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<p>Bu grafiği yüzdesel oranlarına göre tam olarak sığdırmak için ise,</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1"><span class="kw">ggplot</span>(plot_df, <span class="kw">aes</span>(<span class="dt">x=</span>Saat, <span class="dt">y=</span>Fiyatlar, <span class="dt">fill=</span>Piyasa_Degiskeni)) <span class="op">+</span></a>
<a class="sourceLine" id="cb44-2" data-line-number="2"><span class="st">            </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="dt">position=</span><span class="st">&quot;fill&quot;</span>)</a></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<p>Son olarak da daha aşina olunduğu üzere sütunları yan yana yerleştirmek için (yukarıda yapılan güzelleştirme operasyonları da uygulanırsa),</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1"><span class="kw">ggplot</span>(plot_df, <span class="kw">aes</span>(<span class="dt">x=</span>Saat, <span class="dt">y=</span>Fiyatlar, <span class="dt">fill=</span>Piyasa_Degiskeni)) <span class="op">+</span></a>
<a class="sourceLine" id="cb45-2" data-line-number="2"><span class="st">            </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="dt">position=</span><span class="st">&quot;dodge&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb45-3" data-line-number="3"><span class="st">            </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Saatler&quot;</span>,</a>
<a class="sourceLine" id="cb45-4" data-line-number="4">                 <span class="dt">y =</span> <span class="st">&quot;Fiyatlar&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb45-5" data-line-number="5"><span class="st">            </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">23</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb45-6" data-line-number="6"><span class="st">            </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>), <span class="dt">legend.position =</span> <span class="st">&quot;top&quot;</span>,</a>
<a class="sourceLine" id="cb45-7" data-line-number="7">                  <span class="dt">legend.title =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<p>Son iki grafikte dikkat edilmesi gereken nokta sütunları dikeyde oranları göz önüne alınarak sığdırmak için <code>position=&quot;fill&quot;</code>, yan yana yerleştirmek için ise <code>position=&quot;dodge&quot;</code> kullanılır.</p>
</div>
<div id="çizgi-grafiği-line-chart" class="section level2">
<h2><span class="header-section-number">3.4</span> Çizgi Grafiği (Line Chart)</h2>
<p>“Line Chart”larda ise tahmin edilebileceği üzere <code>geom_line()</code> kullanılacaktır. Örneğin Şubat ayı saatlik ortalama PTF ve SMF değerleri incelenmek isteniyor. Önce veri manipülasyonu yapılırsa,</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1">plot_df &lt;-<span class="st"> </span>ptfsmf <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb46-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Tarih =</span> <span class="kw">as_date</span>(Tarih)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb46-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(Tarih<span class="op">&gt;</span><span class="st">&quot;2019-01-31&quot;</span> <span class="op">&amp;</span><span class="st"> </span>Tarih<span class="op">&lt;</span><span class="st">&quot;2019-03-01&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb46-4" data-line-number="4"><span class="st">  </span><span class="kw">group_by</span>(Tarih) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb46-5" data-line-number="5"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">PTF =</span> <span class="kw">mean</span>(PTF), <span class="dt">SMF =</span> <span class="kw">mean</span>(SMF)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb46-6" data-line-number="6"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb46-7" data-line-number="7"><span class="st">  </span><span class="kw">gather</span>(<span class="dt">key=</span>Piyasa_Degiskeni, <span class="dt">value=</span>Fiyatlar, <span class="op">-</span><span class="kw">c</span>(Tarih))</a></code></pre></div>
<p>Bu şekilde bir tablo ortaya çıkıyor. Şimdi grafik çizdirilirse,</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1"><span class="kw">ggplot</span>(plot_df, <span class="kw">aes</span>(<span class="dt">x=</span>Tarih, <span class="dt">y=</span>Fiyatlar, <span class="dt">color=</span>Piyasa_Degiskeni)) <span class="op">+</span></a>
<a class="sourceLine" id="cb47-2" data-line-number="2"><span class="st">           </span><span class="kw">geom_line</span>()</a></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
<p>Yine daha güzel görünümlü bir grafik elde etmek için gerekli fonksiyonlar da yazılırsa,</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1"><span class="kw">ggplot</span>(plot_df, <span class="kw">aes</span>(<span class="dt">x=</span>Tarih, <span class="dt">y=</span>Fiyatlar, <span class="dt">color=</span>Piyasa_Degiskeni)) <span class="op">+</span></a>
<a class="sourceLine" id="cb48-2" data-line-number="2"><span class="st">           </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb48-3" data-line-number="3"><span class="st">           </span><span class="kw">theme_minimal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb48-4" data-line-number="4"><span class="st">           </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Tarih&quot;</span>,</a>
<a class="sourceLine" id="cb48-5" data-line-number="5">                <span class="dt">y =</span> <span class="st">&quot;Fiyatlar&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb48-6" data-line-number="6"><span class="st">           </span><span class="kw">scale_x_date</span>(<span class="dt">date_breaks =</span> <span class="st">&quot;1 day&quot;</span>, <span class="dt">date_labels =</span> <span class="st">&quot;%m/%d&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb48-7" data-line-number="7"><span class="st">           </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>), <span class="dt">legend.position =</span> <span class="st">&quot;top&quot;</span>,</a>
<a class="sourceLine" id="cb48-8" data-line-number="8">                 <span class="dt">legend.title =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
</div>
<div id="isı-harıtası-heat-map" class="section level2">
<h2><span class="header-section-number">3.5</span> Isı Harıtası (Heat Map)</h2>
<p>Bu grafik türünde ise iki farklı değişken baz alınarak temelde gözlenmek istenen değişkeni farklı renk tonlarında göstererek incelenmesi hedefleniyor. Bu işlem için ise <code>geom_tile()</code> fonksiyonu kullanılıyor ve asıl olarak gösterilmek istenen değişken <code>fill</code> fonksiyonuna veriliyor.</p>
<p>Örneğin temmuz ayı için x ekseninde saatler, y ekseninde ise ayın günleri olacak şekilde Piyasa Takas Fiyatı (PTF) değişkeninin ısı grafiği için (Öncelikle veri manipülasyonu yapılıyor.),</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1">plot_df &lt;-<span class="st"> </span>ptfsmf <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb49-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Saat =</span> <span class="kw">hour</span>(Tarih), <span class="dt">Tarih =</span> <span class="kw">as_date</span>(Tarih)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb49-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(Tarih<span class="op">&gt;</span><span class="st">&quot;2019-06-30&quot;</span> <span class="op">&amp;</span><span class="st"> </span>Tarih<span class="op">&lt;</span><span class="st">&quot;2019-08-01&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb49-4" data-line-number="4"><span class="st">  </span><span class="kw">select</span>(Saat, Tarih, PTF)</a></code></pre></div>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1"><span class="kw">ggplot</span>(plot_df, <span class="kw">aes</span>(<span class="dt">x=</span>Saat, <span class="dt">y=</span>Tarih, <span class="dt">fill=</span>PTF)) <span class="op">+</span></a>
<a class="sourceLine" id="cb50-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_tile</span>()</a></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
<p>Güzelleştirmek için yukarıdaki fonksiyonlar eklenirse,</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1"><span class="kw">ggplot</span>(plot_df, <span class="kw">aes</span>(<span class="dt">x=</span>Saat, <span class="dt">y=</span>Tarih, <span class="dt">fill=</span>PTF)) <span class="op">+</span></a>
<a class="sourceLine" id="cb51-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_tile</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb51-3" data-line-number="3"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Saatler&quot;</span>,</a>
<a class="sourceLine" id="cb51-4" data-line-number="4">       <span class="dt">y =</span> <span class="st">&quot;Günler&quot;) +</span></a>
<a class="sourceLine" id="cb51-5" data-line-number="5"><span class="st">  scale_y_date(date_breaks = &quot;</span><span class="dv">5</span> day<span class="st">&quot;, date_labels = &quot;</span><span class="op">%m/%</span>d<span class="st">&quot;) +</span></a>
<a class="sourceLine" id="cb51-6" data-line-number="6"><span class="st">  scale_x_discrete(limits=c(0:23)) +</span></a>
<a class="sourceLine" id="cb51-7" data-line-number="7"><span class="st">  theme(axis.text.x = element_text(angle = 45), legend.position = &quot;</span>top<span class="st">&quot;,</span></a>
<a class="sourceLine" id="cb51-8" data-line-number="8"><span class="st">        legend.title = element_blank())</span></a></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
<p>Isı grafiğinin rengi değiştirilmek istenirse ise <code>scale_fill_gradient</code> fonksiyonu içerisinde iki renk belirtilerek aralarındaki renkler kullanılabilir.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1"><span class="kw">ggplot</span>(plot_df, <span class="kw">aes</span>(<span class="dt">x=</span>Saat, <span class="dt">y=</span>Tarih, <span class="dt">fill=</span>PTF)) <span class="op">+</span></a>
<a class="sourceLine" id="cb52-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_tile</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb52-3" data-line-number="3"><span class="st">  </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low=</span><span class="st">&quot;white&quot;</span>, <span class="dt">high=</span><span class="st">&quot;red&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb52-4" data-line-number="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Saatler&quot;</span>,</a>
<a class="sourceLine" id="cb52-5" data-line-number="5">       <span class="dt">y =</span> <span class="st">&quot;Günler&quot;) +</span></a>
<a class="sourceLine" id="cb52-6" data-line-number="6"><span class="st">  scale_y_date(date_breaks = &quot;</span><span class="dv">5</span> day<span class="st">&quot;, date_labels = &quot;</span><span class="op">%m/%</span>d<span class="st">&quot;) +</span></a>
<a class="sourceLine" id="cb52-7" data-line-number="7"><span class="st">  scale_x_discrete(limits=c(0:23)) +</span></a>
<a class="sourceLine" id="cb52-8" data-line-number="8"><span class="st">  theme(axis.text.x = element_text(angle = 45), legend.position = &quot;</span>top<span class="st">&quot;,</span></a>
<a class="sourceLine" id="cb52-9" data-line-number="9"><span class="st">        legend.title = element_blank())</span></a></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="dplyr-ile-veri-manipülasyonu.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ekler.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["book.pdf", "PDF"], ["book.epub", "EPUB"]],
"toc": {
"collapse": "none",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": true,
"info": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
